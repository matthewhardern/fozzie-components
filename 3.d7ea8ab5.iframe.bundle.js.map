{"version":3,"file":"3.d7ea8ab5.iframe.bundle.js","sources":["webpack:////home/runner/work/fozzie-components/fozzie-components/node_modules/@justeattakeaway/cc-braze-adapter/node_modules/@braze/web-sdk/src/FeatureFlags/feature-flag.js","webpack:////home/runner/work/fozzie-components/fozzie-components/node_modules/@justeattakeaway/cc-braze-adapter/node_modules/@braze/web-sdk/src/FeatureFlags/feature-flag-factory.js","webpack:////home/runner/work/fozzie-components/fozzie-components/node_modules/@justeattakeaway/cc-braze-adapter/node_modules/@braze/web-sdk/src/FeatureFlags/feature-flags-provider.js","webpack:////home/runner/work/fozzie-components/fozzie-components/node_modules/@justeattakeaway/cc-braze-adapter/node_modules/@braze/web-sdk/src/FeatureFlags/feature-flags-provider-factory.js","webpack:////home/runner/work/fozzie-components/fozzie-components/node_modules/@justeattakeaway/cc-braze-adapter/node_modules/@braze/web-sdk/src/FeatureFlags/refresh-feature-flags.js"],"sourcesContent":["import r from \"../../shared-lib/braze-shared-lib.js\";\nexport default class FeatureFlag {\n  constructor(t, r = !1, e = {}) {\n    (this.id = t),\n      (this.enabled = r),\n      (this.properties = e),\n      (this.id = t),\n      (this.enabled = r),\n      (this.properties = e);\n  }\n  getStringProperty(t) {\n    const r = this.properties[t];\n    return null == r\n      ? (this.yr(t), null)\n      : this.Er(r)\n      ? r.value\n      : (this.Br(\"string\"), null);\n  }\n  getNumberProperty(t) {\n    const r = this.properties[t];\n    return null == r\n      ? (this.yr(t), null)\n      : this.Ir(r)\n      ? r.value\n      : (this.Br(\"number\"), null);\n  }\n  getBooleanProperty(t) {\n    const r = this.properties[t];\n    return null == r\n      ? (this.yr(t), null)\n      : this.Nr(r)\n      ? r.value\n      : (this.Br(\"boolean\"), null);\n  }\n  ss() {\n    const t = {};\n    return (\n      (t[FeatureFlag.hs.ns] = this.id),\n      (t[FeatureFlag.hs.Fe] = this.enabled),\n      (t[FeatureFlag.hs.we] = this.properties),\n      t\n    );\n  }\n  Br(t) {\n    r.D.info(`Property is not of type ${t}.`);\n  }\n  yr(t) {\n    r.D.info(`${t} not found in feature flag properties.`);\n  }\n  Er(t) {\n    return \"string\" === t.type && \"string\" == typeof t.value;\n  }\n  Ir(t) {\n    return \"number\" === t.type && \"number\" == typeof t.value;\n  }\n  Nr(t) {\n    return \"boolean\" === t.type && \"boolean\" == typeof t.value;\n  }\n}\n(FeatureFlag.hs = { ns: \"id\", Fe: \"e\", we: \"pr\" }),\n  (FeatureFlag.At = { ns: \"id\", Fe: \"enabled\", we: \"properties\" });\n","import r from \"../../shared-lib/braze-shared-lib.js\";\nimport FeatureFlag from \"./feature-flag.js\";\nexport function newFeatureFlagFromJson(e) {\n  if (e[FeatureFlag.At.ns] && \"boolean\" == typeof e[FeatureFlag.At.Fe])\n    return new FeatureFlag(\n      e[FeatureFlag.At.ns],\n      e[FeatureFlag.At.Fe],\n      e[FeatureFlag.At.we]\n    );\n  r.D.info(`Unable to create feature flag from ${JSON.stringify(e, null, 2)}`);\n}\nexport function newFeatureFlagFromSerializedValue(e) {\n  if (e[FeatureFlag.hs.ns] && \"boolean\" == typeof e[FeatureFlag.hs.Fe])\n    return new FeatureFlag(\n      e[FeatureFlag.hs.ns],\n      e[FeatureFlag.hs.Fe],\n      e[FeatureFlag.hs.we]\n    );\n  r.D.info(\n    `Unable to deserialize feature flag from ${JSON.stringify(e, null, 2)}`\n  );\n}\n","import r from \"../../shared-lib/braze-shared-lib.js\";\nimport y from \"../common/base-provider.js\";\nimport e from \"../managers/braze-instance.js\";\nimport { STORAGE_KEYS as o } from \"../managers/storage-manager.js\";\nimport u from \"../managers/subscription-manager.js\";\nimport { randomInclusive as tt } from \"../util/math.js\";\nimport b from \"../util/net.js\";\nimport {\n  newFeatureFlagFromJson as st,\n  newFeatureFlagFromSerializedValue as it\n} from \"./feature-flag-factory.js\";\nexport default class er extends y {\n  constructor(t, s, i) {\n    super(),\n      (this.si = t),\n      (this.ei = s),\n      (this.ri = i),\n      (this.hi = []),\n      (this.oi = 0),\n      (this.si = t),\n      (this.ei = s),\n      (this.ri = i),\n      (this.ni = null),\n      (this.ai = new u()),\n      (this.fi = 10),\n      (this.ui = null),\n      (this.li = null),\n      e.jt(this.ai);\n  }\n  Rs(t) {\n    if ((!this.si || this.si.ci()) && null != t && t.feature_flags) {\n      this.hi = [];\n      for (const s of t.feature_flags) {\n        const t = st(s);\n        t && this.hi.push(t);\n      }\n      (this.oi = new Date().getTime()), this.mi(), this.ai.St(this.hi);\n    }\n  }\n  pi() {\n    let t = {};\n    this.ri && (t = this.ri.I(o.q.di));\n    const s = {};\n    for (const i in t) {\n      const e = it(t[i]);\n      e && (s[e.id] = e);\n    }\n    return s;\n  }\n  Ws(t) {\n    return this.ai.ut(t);\n  }\n  refreshFeatureFlags(t, s, i = !1, e = !0) {\n    if (!this.gi(i))\n      return (\n        !this.ni &&\n          this.si &&\n          (this.ni = this.si.Fi(() => {\n            this.refreshFeatureFlags(t, s);\n          })),\n        void (\"function\" == typeof s && s())\n      );\n    if ((e && this.yi(), !this.ei)) return void (\"function\" == typeof s && s());\n    const r = this.ei.Ps({}, !0),\n      h = this.ei.Bs(r, !1, !0);\n    let o = !1;\n    this.ei.Gs(r, () => {\n      this.ei\n        ? b.Hs({\n            url: `${this.ei.Ks()}/feature_flags/sync`,\n            headers: h,\n            data: r,\n            S: i => {\n              if (!this.ei.Os(r, i, h))\n                return (o = !0), void (\"function\" == typeof s && s());\n              this.ei.Qs(), this.Rs(i), \"function\" == typeof t && t();\n            },\n            error: t => {\n              this.ei.Vs(t, \"retrieving feature flags\"),\n                (o = !0),\n                \"function\" == typeof s && s();\n            },\n            wi: () => {\n              if (e && o && !this.li) {\n                let e = this.ui;\n                (null == e || e < 1e3 * this.fi) && (e = 1e3 * this.fi),\n                  this.bi(Math.min(3e5, tt(1e3 * this.fi, 3 * e)), t, s, i);\n              }\n            }\n          })\n        : \"function\" == typeof s && s();\n    });\n  }\n  yi() {\n    null != this.li && (clearTimeout(this.li), (this.li = null));\n  }\n  bi(t = 1e3 * this.fi, s, i, e) {\n    this.yi(),\n      (this.li = window.setTimeout(() => {\n        this.refreshFeatureFlags(s, i, e);\n      }, t)),\n      (this.ui = t);\n  }\n  gi(t) {\n    if (!this.si) return !1;\n    if (!t) {\n      const t = parseFloat(this.si.ji());\n      let s = !1;\n      if (!isNaN(t)) {\n        if (-1 === t) return r.D.info(\"Feature flag refreshes not allowed\"), !1;\n        s = new Date().getTime() >= (this.oi || 0) + 1e3 * t;\n      }\n      if (!s)\n        return (\n          r.D.info(`Feature flag refreshes were rate limited to ${t} seconds`),\n          !1\n        );\n    }\n    return this.si.ci();\n  }\n  mi() {\n    if (!this.ri) return;\n    const t = {};\n    for (const s of this.hi) {\n      const i = s.ss();\n      t[s.id] = i;\n    }\n    this.ri.B(o.q.di, t), this.ri.B(o.q.vi, this.oi);\n  }\n}\n","import e from \"../managers/braze-instance.js\";\nimport er from \"./feature-flags-provider.js\";\nconst ir = {\n  t: !1,\n  provider: null,\n  er: () => (\n    ir.o(),\n    ir.provider ||\n      ((ir.provider = new er(e.ir(), e.nr(), e.l())), e.ar(ir.provider)),\n    ir.provider\n  ),\n  o: () => {\n    ir.t || (e.u(ir), (ir.t = !0));\n  },\n  destroy: () => {\n    (ir.provider = null), (ir.t = !1);\n  }\n};\nexport default ir;\n","import e from \"../managers/braze-instance.js\";\nimport ir from \"./feature-flags-provider-factory.js\";\nfunction tr(r, t, a = !1) {\n  if (e.rr()) return ir.er().refreshFeatureFlags(r, t, a);\n}\nexport function refreshFeatureFlags(r, e) {\n  tr(r, e);\n}\nexport default tr;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACjIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;A","sourceRoot":""}